<!DOCTYPE html>
<html lang="en">
<head>
    <title>AR with Model-Viewer</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link type="text/css" rel="stylesheet" href="main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/@google/model-viewer"></script>
</head>
<body>

    <div id="content">
        <div id="mySidenav" class="sidenav">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a class="ar-object" id="item_1" href="#">Item 1</a>
            <a class="ar-object" id="item_2" href="#">Item 2</a>
        </div>

        <span style="font-size:30px;cursor:pointer;" onclick="openNav()">&#9776; open</span>

        <model-viewer id="modelViewer" src="Assets/1.glb" ios-src="Assets/1.usdz" ar ar-scale="fixed" camera-controls auto-rotate style="width: 100%; height: 100vh;" alt="3D Model">
        </model-viewer>

        <button type="button" id="place-button" style="position: absolute;">PLACE</button>
    </div>

    <script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "250px";
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
        }

        $(".ar-object").click(function() {
            // Change the model based on the selected item
            let selectedModel = $(this).attr("id");
            switchModel(selectedModel);
        });

        function switchModel(modelId) {
            let modelViewer = document.getElementById("modelViewer");
            if (modelId === "item_1") {
                modelViewer.src = "Assets/1.glb";
                modelViewer.setAttribute('ios-src', 'Assets/1.usdz');
            } else if (modelId === "item_2") {
                modelViewer.src = "Assets/model2.glb";
                modelViewer.setAttribute('ios-src', 'Assets/model2.usdz');
            }
        }

        // No need for manual hit test or placement; Model-Viewer handles AR natively
        document.getElementById("place-button").addEventListener("click", function() {
            let viewer = document.querySelector('model-viewer');
            viewer.activateAR();
        });
    </script>
</body>
</html>
